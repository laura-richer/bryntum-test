import Override from '../../mixin/Override.js';
import ElementVisitor from '../../util/ElementVisitor.js';
import createTreeWalker, { NodeFilter } from './TreeWalker.js';

/*
 * ElementVisitor override to use custom TreeWalker implementation
 * @private
 */
class ElementVisitorOverride {
    static get target() {
        return {
            class : ElementVisitor
        };
    }

    updateSelector(selector) {
        this.treeWalker = createTreeWalker(this.element, NodeFilter.SHOW_ELEMENT, typeof selector === 'string' ? node => node.matches?.(selector) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP : selector);
    }
}

Override.apply(ElementVisitorOverride);
